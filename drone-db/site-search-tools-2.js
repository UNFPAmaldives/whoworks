TWP.Util.toTitleCase=function(e){for(var t="",n=e.split(" "),r=0;r<n.length;r++)t+=n[r].substr(0,1).toUpperCase()+n[r].substr(1),t+=r<n.length-1?" ":"";return t},jQuery.queryToUL=function(e){var t;if(e.query)t=e.query;else{var n=jQuery("meta[name=keywords]").attr("content"),r=-1!==n.indexOf(";")?/;/g:/,/g,a=encodeURIComponent(n.replace(r," OR ")),o=thisNode||navNode||"";o=o.split("/")[0];var l=e.items||8;t="https://md1-a.akamaihd.net/wpost-content-api/content/v2/search.jsonp?appkey=relatedcontent&query="+a+"&startingrow=0&offset="+l+"&fields=contenturl,byline,headline,blurb,primarysection,source&filters=primarysection:("+TWP.Util.toTitleCase(o)+")%20AND%20source:(%22The%20Washington%20Post%22)&wt=json&omitHeader=true&json.wrf=storyCallback&tracking=relatedcontent"}var i={url:t};i.dataType=e.callback?"jsonp":"json",i.success=function(t){if(e.mobileQuery){var n=[];jQuery.each(t.results.documents,function(e,t){t.headline&&t.contenturl&&"Corrections"!==t.headline&&"Photo"!==t.contenttype&&n.push('<div class="article"><a href="'+t.contenturl+'""><p class="headline">'+t.headline+"</p></a></div>")}),jQuery.isArray(e.container)?jQuery.each(e.container,function(e,t){jQuery(t).html(n.join(""))}):jQuery(e.container).html(n.join(""))}else{var r="";e.s1>0&&jQuery.each(t.results.documents,function(t,n){if(t<e.s1&&n.headline&&"Corrections"!==n.headline&&"Photo"!==n.contenttype){var a="";a+='<div class="module wp-pad-bottom">',a+='<h2><a href="'+n.contenturl+'">'+n.headline+"</a></h2>",n.byline&&(a+='<p class="byline">'+n.byline+"</p>"),n.blurb&&(a+="<p>"+n.blurb+"</p>"),a+="</div>",r+=a}}),r+='<ul class="normal">',jQuery.each(t.results.documents,function(t,n){e.s1&&t<e.s1||n.headline&&n.contenturl&&"Corrections"!==n.headline&&"Photo"!==n.contenttype&&(r+='<li><a href="'+n.contenturl+'">'+n.headline+"</a></li>")}),r+="</ul>",jQuery.isArray(e.container)?jQuery.each(e.container,function(e,t){jQuery(t).html(r)}):jQuery(e.container).html(r)}},e.callback&&(i.jsonpCallback=e.callback),jQuery.ajax(i)};
